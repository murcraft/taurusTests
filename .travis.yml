#dist: trusty
#
#jobs:
#  include:
#    - stage: pull docker taurus
#      script:
#        - echo "${DOCKER_USERNAME}" | docker login -u ${DOCKER_USERNAME} -p ${DOCKER_PASSWORD}
#        - docker pull blazemeter/taurus
#        - docker tag blazemeter/taurus
#        - docker images
#    - stage: test
#      script: docker run --rm -v $(pwd)/scripts:/bzt-configs -v $(pwd)/artifacts:/tmp/artifacts blazemeter/taurus
#
#addons:
#  artifacts:
#      paths:
#        - ./artifacts
#      target_paths: $TRAVIS_BUILD_NUMBER/$TRAVIS_JOB_NUMBER/results
sudo: true
dist: trusty

jobs:
  include:
    - stage: build docker image
      script:
      - docker login -u="$DOCKER_USERNAME" -p="$DOCKER_PASSWORD"
      - docker build -t travis-ci-build-stages-demo .
      - docker images
      - docker tag travis-ci-build-stages-demo $DOCKER_USERNAME/travis-ci-build-stages-demo
      - docker push $DOCKER_USERNAME/travis-ci-build-stages-demo
    - stage: test
      script: docker run --rm $DOCKER_USERNAME/travis-ci-build-stages-demo cat hello.txt
    - script: docker run --rm $DOCKER_USERNAME/travis-ci-build-stages-demo cat hello.txt